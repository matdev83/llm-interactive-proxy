No client API key provided, generated one: xNnQV-1p8C5XlKqn1mbV8B-sE8wN6mdpZUwk-C1VJp4
Generated client API key: xNnQV-1p8C5XlKqn1mbV8B-sE8wN6mdpZUwk-C1VJp4
2025-06-10 16:03:36,015 - root - WARNING - Client authentication is DISABLED
2025-06-10 16:03:36,019 - asyncio - DEBUG - Using proactor: IocpProactor
INFO:     Started server process [24756]
INFO:     Waiting for application startup.
2025-06-10 16:03:36,146 - httpcore.connection - DEBUG - connect_tcp.started host='openrouter.ai' port=443 local_address=None timeout=300 socket_options=None
2025-06-10 16:03:36,153 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000022586B9E050>
2025-06-10 16:03:36,153 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000022586B88340> server_hostname='openrouter.ai' timeout=300
2025-06-10 16:03:36,162 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000022586A91FC0>
2025-06-10 16:03:36,163 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-10 16:03:36,163 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-06-10 16:03:36,163 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-10 16:03:36,163 - httpcore.http11 - DEBUG - send_request_body.complete
2025-06-10 16:03:36,163 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-10 16:03:36,316 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 10 Jun 2025 14:03:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'Access-Control-Allow-Origin', b'*'), (b'Cdn-Cache-Control', b'max-age=300'), (b'Vary', b'Accept-Encoding'), (b'Server', b'cloudflare'), (b'Cf-Ray', b'94d969becf18c3c1-WAW')])
2025-06-10 16:03:36,317 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2025-06-10 16:03:36,317 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-10 16:03:36,350 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-06-10 16:03:36,350 - httpcore.http11 - DEBUG - response_closed.started
2025-06-10 16:03:36,350 - httpcore.http11 - DEBUG - response_closed.complete
2025-06-10 16:03:36,354 - httpcore.connection - DEBUG - connect_tcp.started host='generativelanguage.googleapis.com' port=443 local_address=None timeout=300 socket_options=None
2025-06-10 16:03:36,357 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000022586BD9480>
2025-06-10 16:03:36,357 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000022586B88340> server_hostname='generativelanguage.googleapis.com' timeout=300
2025-06-10 16:03:36,378 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000022586BDAFE0>
2025-06-10 16:03:36,378 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-10 16:03:36,378 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-06-10 16:03:36,378 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-10 16:03:36,378 - httpcore.http11 - DEBUG - send_request_body.complete
2025-06-10 16:03:36,378 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-10 16:03:36,413 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=UTF-8'), (b'Vary', b'Origin'), (b'Vary', b'X-Origin'), (b'Vary', b'Referer'), (b'Content-Encoding', b'gzip'), (b'Date', b'Tue, 10 Jun 2025 14:03:36 GMT'), (b'Server', b'scaffolding on HTTPServer2'), (b'X-XSS-Protection', b'0'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'X-Content-Type-Options', b'nosniff'), (b'Server-Timing', b'gfet4t7; dur=32'), (b'Alt-Svc', b'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'), (b'Transfer-Encoding', b'chunked')])
2025-06-10 16:03:36,413 - httpx - INFO - HTTP Request: GET https://generativelanguage.googleapis.com/v1beta/models "HTTP/1.1 200 OK"
2025-06-10 16:03:36,413 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-10 16:03:36,414 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-06-10 16:03:36,414 - httpcore.http11 - DEBUG - response_closed.started
2025-06-10 16:03:36,414 - httpcore.http11 - DEBUG - response_closed.complete
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-06-10 16:03:47,794 - src.session - INFO - Created new session: default
2025-06-10 16:03:47,794 - src.session - DEBUG - Retrieving session: default, ProxyState ID: 2360197963616
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Processing text for commands: '<task>
!/hello
</task>'
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Found 1 command matches for text: '<task>
!/hello
</task>'
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Regex match: Full='!/hello', Command='hello', ArgsStr=''
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Parsing arguments from string: ''
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Argument string is empty, returning empty dict.
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Text after command processing and normalization: ' '
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Processing text for commands: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Found 0 command matches for text: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:47,795 - src.command_parser - DEBUG - Text after command processing and normalization: ' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py '
2025-06-10 16:03:47,796 - src.command_parser - INFO - Commands processed in message index 1 (from end). Role: user. New content: '[MessageContentPartText(type='text', text=' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER\'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py ')]'
2025-06-10 16:03:47,796 - src.command_parser - DEBUG - Finished processing messages. Final message count: 2. Commands processed overall: True
2025-06-10 16:03:47,796 - __main__ - DEBUG - Attempting backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1
2025-06-10 16:03:47,796 - httpcore.connection - DEBUG - close.started
2025-06-10 16:03:47,796 - httpcore.connection - DEBUG - close.complete
2025-06-10 16:03:47,796 - httpcore.connection - DEBUG - close.started
2025-06-10 16:03:47,796 - httpcore.connection - DEBUG - close.complete
2025-06-10 16:03:47,797 - httpcore.connection - DEBUG - connect_tcp.started host='generativelanguage.googleapis.com' port=443 local_address=None timeout=300 socket_options=None
2025-06-10 16:03:47,799 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000022586C2E230>
2025-06-10 16:03:47,799 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000022586B88340> server_hostname='generativelanguage.googleapis.com' timeout=300
2025-06-10 16:03:47,821 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000022586BDAB60>
2025-06-10 16:03:47,821 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-10 16:03:47,821 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-06-10 16:03:47,821 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-10 16:03:47,821 - httpcore.http11 - DEBUG - send_request_body.complete
2025-06-10 16:03:47,821 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-10 16:03:49,111 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 500, b'Internal Server Error', [(b'Vary', b'Origin'), (b'Vary', b'X-Origin'), (b'Vary', b'Referer'), (b'Content-Type', b'application/json; charset=UTF-8'), (b'Content-Encoding', b'gzip'), (b'Date', b'Tue, 10 Jun 2025 14:03:49 GMT'), (b'Server', b'scaffolding on HTTPServer2'), (b'X-XSS-Protection', b'0'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'X-Content-Type-Options', b'nosniff'), (b'Server-Timing', b'gfet4t7; dur=1287'), (b'Alt-Svc', b'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'), (b'Transfer-Encoding', b'chunked')])
2025-06-10 16:03:49,111 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:streamGenerateContent "HTTP/1.1 500 Internal Server Error"
2025-06-10 16:03:49,111 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-10 16:03:49,112 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-06-10 16:03:49,112 - httpcore.http11 - DEBUG - response_closed.started
2025-06-10 16:03:49,112 - httpcore.http11 - DEBUG - response_closed.complete
2025-06-10 16:03:49,112 - src.connectors.gemini - ERROR - HTTP error during Gemini stream: 500 - [{
  "error": {
    "code": 500,
    "message": "An internal error has occurred. Please retry or report in https://developers.generativeai.google/guide/troubleshooting",
    "status": "INTERNAL"
  }
}
]
2025-06-10 16:03:49,112 - __main__ - DEBUG - Attempt failed for backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1 with HTTPException: 500 - {'message': 'Gemini stream error: 500 - [{\n  "error": {\n    "code": 500,\n    "message": "An internal error has occurred. Please retry or report in https://developers.generativeai.google/guide/troubleshooting",\n    "status": "INTERNAL"\n  }\n}\n]', 'type': 'gemini_error', 'code': 500}
INFO:     127.0.0.1:16460 - "POST /v1/chat/completions HTTP/1.1" 500 Internal Server Error
2025-06-10 16:03:49,507 - src.session - DEBUG - Retrieving session: default, ProxyState ID: 2360197963616
2025-06-10 16:03:49,507 - src.command_parser - DEBUG - Processing text for commands: '<task>
!/hello
</task>'
2025-06-10 16:03:49,507 - src.command_parser - DEBUG - Found 1 command matches for text: '<task>
!/hello
</task>'
2025-06-10 16:03:49,508 - src.command_parser - DEBUG - Regex match: Full='!/hello', Command='hello', ArgsStr=''
2025-06-10 16:03:49,508 - src.command_parser - DEBUG - Parsing arguments from string: ''
2025-06-10 16:03:49,508 - src.command_parser - DEBUG - Argument string is empty, returning empty dict.
2025-06-10 16:03:49,508 - src.command_parser - DEBUG - Text after command processing and normalization: ' '
2025-06-10 16:03:49,508 - src.command_parser - DEBUG - Processing text for commands: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:49,508 - src.command_parser - DEBUG - Found 0 command matches for text: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:49,508 - src.command_parser - DEBUG - Text after command processing and normalization: ' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py '
2025-06-10 16:03:49,508 - src.command_parser - INFO - Commands processed in message index 1 (from end). Role: user. New content: '[MessageContentPartText(type='text', text=' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER\'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py ')]'
2025-06-10 16:03:49,509 - src.command_parser - DEBUG - Finished processing messages. Final message count: 2. Commands processed overall: True
2025-06-10 16:03:49,509 - __main__ - DEBUG - Attempting backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1
2025-06-10 16:03:49,509 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-10 16:03:49,510 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-06-10 16:03:49,510 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-10 16:03:49,510 - httpcore.http11 - DEBUG - send_request_body.complete
2025-06-10 16:03:49,510 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-10 16:03:50,444 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 500, b'Internal Server Error', [(b'Vary', b'Origin'), (b'Vary', b'X-Origin'), (b'Vary', b'Referer'), (b'Content-Type', b'application/json; charset=UTF-8'), (b'Content-Encoding', b'gzip'), (b'Date', b'Tue, 10 Jun 2025 14:03:50 GMT'), (b'Server', b'scaffolding on HTTPServer2'), (b'X-XSS-Protection', b'0'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'X-Content-Type-Options', b'nosniff'), (b'Server-Timing', b'gfet4t7; dur=932'), (b'Alt-Svc', b'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'), (b'Transfer-Encoding', b'chunked')])
2025-06-10 16:03:50,445 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:streamGenerateContent "HTTP/1.1 500 Internal Server Error"
2025-06-10 16:03:50,445 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-10 16:03:50,445 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-06-10 16:03:50,445 - httpcore.http11 - DEBUG - response_closed.started
2025-06-10 16:03:50,445 - httpcore.http11 - DEBUG - response_closed.complete
2025-06-10 16:03:50,446 - src.connectors.gemini - ERROR - HTTP error during Gemini stream: 500 - [{
  "error": {
    "code": 500,
    "message": "An internal error has occurred. Please retry or report in https://developers.generativeai.google/guide/troubleshooting",
    "status": "INTERNAL"
  }
}
]
2025-06-10 16:03:50,446 - __main__ - DEBUG - Attempt failed for backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1 with HTTPException: 500 - {'message': 'Gemini stream error: 500 - [{\n  "error": {\n    "code": 500,\n    "message": "An internal error has occurred. Please retry or report in https://developers.generativeai.google/guide/troubleshooting",\n    "status": "INTERNAL"\n  }\n}\n]', 'type': 'gemini_error', 'code': 500}
INFO:     127.0.0.1:16462 - "POST /v1/chat/completions HTTP/1.1" 500 Internal Server Error
2025-06-10 16:03:51,460 - src.session - DEBUG - Retrieving session: default, ProxyState ID: 2360197963616
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Processing text for commands: '<task>
!/hello
</task>'
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Found 1 command matches for text: '<task>
!/hello
</task>'
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Regex match: Full='!/hello', Command='hello', ArgsStr=''
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Parsing arguments from string: ''
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Argument string is empty, returning empty dict.
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Text after command processing and normalization: ' '
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Processing text for commands: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Found 0 command matches for text: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:51,460 - src.command_parser - DEBUG - Text after command processing and normalization: ' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py '
2025-06-10 16:03:51,461 - src.command_parser - INFO - Commands processed in message index 1 (from end). Role: user. New content: '[MessageContentPartText(type='text', text=' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER\'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py ')]'
2025-06-10 16:03:51,461 - src.command_parser - DEBUG - Finished processing messages. Final message count: 2. Commands processed overall: True
2025-06-10 16:03:51,461 - __main__ - DEBUG - Attempting backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1
2025-06-10 16:03:51,462 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-10 16:03:51,462 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-06-10 16:03:51,463 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-10 16:03:51,463 - httpcore.http11 - DEBUG - send_request_body.complete
2025-06-10 16:03:51,463 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-10 16:03:53,186 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=UTF-8'), (b'Vary', b'Origin'), (b'Vary', b'X-Origin'), (b'Vary', b'Referer'), (b'Content-Encoding', b'gzip'), (b'Date', b'Tue, 10 Jun 2025 14:03:53 GMT'), (b'Server', b'scaffolding on HTTPServer2'), (b'X-XSS-Protection', b'0'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'X-Content-Type-Options', b'nosniff'), (b'Server-Timing', b'gfet4t7; dur=1720'), (b'Alt-Svc', b'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'), (b'Transfer-Encoding', b'chunked')])
2025-06-10 16:03:53,186 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:streamGenerateContent "HTTP/1.1 200 OK"
2025-06-10 16:03:53,186 - __main__ - DEBUG - Result from Gemini backend chat_completions: <starlette.responses.StreamingResponse object at 0x0000022586C2FFD0>
2025-06-10 16:03:53,186 - __main__ - DEBUG - Attempt successful for backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1
INFO:     127.0.0.1:16463 - "POST /v1/chat/completions HTTP/1.1" 200 OK
2025-06-10 16:03:53,187 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-10 16:03:53,191 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-06-10 16:03:53,191 - httpcore.http11 - DEBUG - response_closed.started
2025-06-10 16:03:53,192 - httpcore.http11 - DEBUG - response_closed.complete
2025-06-10 16:03:53,355 - src.session - DEBUG - Retrieving session: default, ProxyState ID: 2360197963616
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Processing text for commands: '[ERROR] You did not use a tool in your previous response! Please retry with a tool use.

# Reminder: Instructions for Tool Use

Tool uses are formatted using XML-style tags. The tool name itself becomes the XML tag name. Each parameter is enclosed within its own set of tags. Here's the structure:

<actual_tool_name>
<parameter1_name>value1</parameter1_name>
<parameter2_name>value2</parameter2_name>
...
</actual_tool_name>

For example, to use the attempt_completion tool:

<attempt_completion>
<result>
I have completed the task...
</result>
</attempt_completion>

Always use the actual tool name as the XML tag name for proper parsing and execution.

# Next Steps

If you have completed the user's task, use the attempt_completion tool. 
If you require additional information from the user, use the ask_followup_question tool. 
Otherwise, if you have not completed the task and do not need additional information, then proceed with the next step of the task. 
(This is an automated message, so do not respond to it conversationally.)'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Found 0 command matches for text: '[ERROR] You did not use a tool in your previous response! Please retry with a tool use.

# Reminder: Instructions for Tool Use

Tool uses are formatted using XML-style tags. The tool name itself becomes the XML tag name. Each parameter is enclosed within its own set of tags. Here's the structure:

<actual_tool_name>
<parameter1_name>value1</parameter1_name>
<parameter2_name>value2</parameter2_name>
...
</actual_tool_name>

For example, to use the attempt_completion tool:

<attempt_completion>
<result>
I have completed the task...
</result>
</attempt_completion>

Always use the actual tool name as the XML tag name for proper parsing and execution.

# Next Steps

If you have completed the user's task, use the attempt_completion tool. 
If you require additional information from the user, use the ask_followup_question tool. 
Otherwise, if you have not completed the task and do not need additional information, then proceed with the next step of the task. 
(This is an automated message, so do not respond to it conversationally.)'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Text after command processing and normalization: '[ERROR] You did not use a tool in your previous response! Please retry with a tool use. # Reminder: Instructions for Tool Use Tool uses are formatted using XML-style tags. The tool name itself becomes the XML tag name. Each parameter is enclosed within its own set of tags. Here's the structure:  value1 value2 ...  For example, to use the attempt_completion tool:   I have completed the task...   Always use the actual tool name as the XML tag name for proper parsing and execution. # Next Steps If you have completed the user's task, use the attempt_completion tool. If you require additional information from the user, use the ask_followup_question tool. Otherwise, if you have not completed the task and do not need additional information, then proceed with the next step of the task. (This is an automated message, so do not respond to it conversationally.)'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Processing text for commands: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:53 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>
</environment_details>'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Found 0 command matches for text: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:53 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>
</environment_details>'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Text after command processing and normalization: ' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:53 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. '
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Processing text for commands: 'I'm ready. Please tell me what you'd like me to do.'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Found 0 command matches for text: 'I'm ready. Please tell me what you'd like me to do.'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Text after command processing and normalization: 'I'm ready. Please tell me what you'd like me to do.'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Non-command-only message (not starting with prefix) processed. Found: False
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Processing text for commands: '<task>
!/hello
</task>'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Found 1 command matches for text: '<task>
!/hello
</task>'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Regex match: Full='!/hello', Command='hello', ArgsStr=''
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Parsing arguments from string: ''
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Argument string is empty, returning empty dict.
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Text after command processing and normalization: ' '
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Processing text for commands: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:53,356 - src.command_parser - DEBUG - Found 0 command matches for text: '<environment_details>
# VSCode Visible Files
README.md

# VSCode Open Tabs
README.md

# Current Time
6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>code</slug>
<name>­čĺ╗ Code</name>
<model>gemini:models/gemini-2.5-flash-preview-05-20</model>
<role>You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.</role>
<custom_instructions>
====

USER'S CUSTOM INSTRUCTIONS

The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines.

Language Preference:
You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise.</custom_instructions>


# Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files
.gitignore
AGENTS.md
pyproject.toml
pytest.ini
README.md
build/lib/agents.py
build/lib/command_parser.py
build/lib/command_prefix.py
build/lib/constants.py
build/lib/main.py
build/lib/models.py
build/lib/proxy_logic.py
build/lib/rate_limit.py
build/lib/security.py
build/lib/session.py
build/lib/commands/__init__.py
build/lib/commands/base.py
build/lib/commands/create_failover_route_cmd.py
build/lib/commands/delete_failover_route_cmd.py
build/lib/commands/failover_base.py
build/lib/commands/hello_cmd.py
build/lib/commands/help_cmd.py
build/lib/commands/list_failover_routes_cmd.py
build/lib/commands/route_append_cmd.py
build/lib/commands/route_clear_cmd.py
build/lib/commands/route_list_cmd.py
build/lib/commands/route_prepend_cmd.py
build/lib/commands/set_cmd.py
build/lib/commands/unset_cmd.py
build/lib/connectors/__init__.py
build/lib/connectors/base.py
build/lib/connectors/gemini.py
build/lib/connectors/openrouter.py
build/lib/core/cli.py
build/lib/core/config.py
build/lib/core/metadata.py
build/lib/core/persistence.py
dev/
dev/example_config.json
dev/test_client.py
dev/test_config.json
docs/
src/
src/agents.py
src/command_parser.py
src/command_prefix.py
src/constants.py
src/main.py
src/models.py
src/proxy_logic.py
src/rate_limit.py
src/security.py
src/session.py
src/commands/__init__.py
src/commands/base.py
src/commands/create_failover_route_cmd.py
src/commands/delete_failover_route_cmd.py
src/commands/failover_base.py
src/commands/hello_cmd.py
src/commands/help_cmd.py
src/commands/list_failover_routes_cmd.py
src/commands/route_append_cmd.py
src/commands/route_clear_cmd.py
src/commands/route_list_cmd.py
src/commands/route_prepend_cmd.py
src/commands/set_cmd.py
src/commands/unset_cmd.py
src/connectors/__init__.py
src/connectors/base.py
src/connectors/gemini.py
src/connectors/openrouter.py
src/core/cli.py
src/core/config.py
src/core/metadata.py
src/core/persistence.py
tests/
tests/__init__.py
tests/conftest.py
tests/integration/__init__.py
tests/integration/test_gemini_end_to_end.py
tests/integration/chat_completions_tests/test_agent_wrapping.py
tests/integration/chat_completions_tests/test_backend_commands.py
tests/integration/chat_completions_tests/test_basic_proxying.py
tests/integration/chat_completions_tests/test_command_only_requests.py
tests/integration/chat_completions_tests/test_commands_disabled.py
tests/integration/chat_completions_tests/test_error_handling.py
tests/integration/chat_completions_tests/test_failover.py
tests/integration/chat_completions_tests/test_help_command.py
tests/integration/chat_completions_tests/test_interactive_banner.py
tests/integration/chat_completions_tests/test_interactive_commands.py
tests/integration/chat_completions_tests/test_model_commands.py
tests/integration/chat_completions_tests/test_project_commands.py
tests/integration/chat_completions_tests/test_rate_limiting.py
tests/integration/chat_completions_tests/test_session_history.py
tests/unit/__init__.py
tests/unit/test_agent_utils.py
tests/unit/test_auth.py
tests/unit/test_cli.py
tests/unit/test_config_persistence.py
tests/unit/test_config.py
tests/unit/test_failover_routes.py
tests/unit/test_model_discovery.py
tests/unit/test_models_endpoint.py
tests/unit/test_no_prints.py
tests/unit/test_prompt_redaction.py
tests/unit/test_proxy_logic.py
tests/unit/test_session_manager.py
tests/unit/gemini_connector_tests/__init__.py
tests/unit/gemini_connector_tests/test_http_error_streaming.py
tests/unit/gemini_connector_tests/test_model_prefix_handling.py
tests/unit/gemini_connector_tests/test_part_conversion.py
tests/unit/gemini_connector_tests/test_streaming_success.py
tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py
tests/unit/openrouter_connector_tests/test_http_error_streaming.py
tests/unit/openrouter_connector_tests/test_non_streaming_success.py
tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py
tests/unit/openrouter_connector_tests/test_redaction.py
tests/unit/openrouter_connector_tests/test_request_error.py
tests/unit/openrouter_connector_tests/test_streaming_success.py
tests/unit/proxy_logic_tests/test_parse_arguments.py
tests/unit/proxy_logic_tests/test_process_commands_in_messages.py
tests/unit/proxy_logic_tests/test_process_text_for_commands.py
</environment_details>'
2025-06-10 16:03:53,357 - src.command_parser - DEBUG - Text after command processing and normalization: ' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py '
2025-06-10 16:03:53,357 - src.command_parser - INFO - Commands processed in message index 1 (from end). Role: user. New content: '[MessageContentPartText(type='text', text=' # VSCode Visible Files README.md # VSCode Open Tabs README.md # Current Time 6/10/2025, 4:03:47 PM (Europe/Warsaw, UTC+2:00) # Current Context Size (Tokens) (Not available) # Current Cost $0.00 # Current Mode code ­čĺ╗ Code gemini:models/gemini-2.5-flash-preview-05-20 You are Roo, a highly skilled software engineer with extensive knowledge in many programming languages, frameworks, design patterns, and best practices.  ==== USER\'S CUSTOM INSTRUCTIONS The following additional instructions are provided by the user, and should be followed to the best of your ability without interfering with the TOOL USE guidelines. Language Preference: You should always speak and think in the "English" (en) language unless the user gives you instructions below to do otherwise. # Current Workspace Directory (c:/Users/Mateusz/source/repos/llm-interactive-proxy) Files .gitignore AGENTS.md pyproject.toml pytest.ini README.md build/lib/agents.py build/lib/command_parser.py build/lib/command_prefix.py build/lib/constants.py build/lib/main.py build/lib/models.py build/lib/proxy_logic.py build/lib/rate_limit.py build/lib/security.py build/lib/session.py build/lib/commands/__init__.py build/lib/commands/base.py build/lib/commands/create_failover_route_cmd.py build/lib/commands/delete_failover_route_cmd.py build/lib/commands/failover_base.py build/lib/commands/hello_cmd.py build/lib/commands/help_cmd.py build/lib/commands/list_failover_routes_cmd.py build/lib/commands/route_append_cmd.py build/lib/commands/route_clear_cmd.py build/lib/commands/route_list_cmd.py build/lib/commands/route_prepend_cmd.py build/lib/commands/set_cmd.py build/lib/commands/unset_cmd.py build/lib/connectors/__init__.py build/lib/connectors/base.py build/lib/connectors/gemini.py build/lib/connectors/openrouter.py build/lib/core/cli.py build/lib/core/config.py build/lib/core/metadata.py build/lib/core/persistence.py dev/ dev/example_config.json dev/test_client.py dev/test_config.json docs/ src/ src/agents.py src/command_parser.py src/command_prefix.py src/constants.py src/main.py src/models.py src/proxy_logic.py src/rate_limit.py src/security.py src/session.py src/commands/__init__.py src/commands/base.py src/commands/create_failover_route_cmd.py src/commands/delete_failover_route_cmd.py src/commands/failover_base.py src/commands/hello_cmd.py src/commands/help_cmd.py src/commands/list_failover_routes_cmd.py src/commands/route_append_cmd.py src/commands/route_clear_cmd.py src/commands/route_list_cmd.py src/commands/route_prepend_cmd.py src/commands/set_cmd.py src/commands/unset_cmd.py src/connectors/__init__.py src/connectors/base.py src/connectors/gemini.py src/connectors/openrouter.py src/core/cli.py src/core/config.py src/core/metadata.py src/core/persistence.py tests/ tests/__init__.py tests/conftest.py tests/integration/__init__.py tests/integration/test_gemini_end_to_end.py tests/integration/chat_completions_tests/test_agent_wrapping.py tests/integration/chat_completions_tests/test_backend_commands.py tests/integration/chat_completions_tests/test_basic_proxying.py tests/integration/chat_completions_tests/test_command_only_requests.py tests/integration/chat_completions_tests/test_commands_disabled.py tests/integration/chat_completions_tests/test_error_handling.py tests/integration/chat_completions_tests/test_failover.py tests/integration/chat_completions_tests/test_help_command.py tests/integration/chat_completions_tests/test_interactive_banner.py tests/integration/chat_completions_tests/test_interactive_commands.py tests/integration/chat_completions_tests/test_model_commands.py tests/integration/chat_completions_tests/test_project_commands.py tests/integration/chat_completions_tests/test_rate_limiting.py tests/integration/chat_completions_tests/test_session_history.py tests/unit/__init__.py tests/unit/test_agent_utils.py tests/unit/test_auth.py tests/unit/test_cli.py tests/unit/test_config_persistence.py tests/unit/test_config.py tests/unit/test_failover_routes.py tests/unit/test_model_discovery.py tests/unit/test_models_endpoint.py tests/unit/test_no_prints.py tests/unit/test_prompt_redaction.py tests/unit/test_proxy_logic.py tests/unit/test_session_manager.py tests/unit/gemini_connector_tests/__init__.py tests/unit/gemini_connector_tests/test_http_error_streaming.py tests/unit/gemini_connector_tests/test_model_prefix_handling.py tests/unit/gemini_connector_tests/test_part_conversion.py tests/unit/gemini_connector_tests/test_streaming_success.py tests/unit/openrouter_connector_tests/test_http_error_non_streaming.py tests/unit/openrouter_connector_tests/test_http_error_streaming.py tests/unit/openrouter_connector_tests/test_non_streaming_success.py tests/unit/openrouter_connector_tests/test_payload_construction_and_headers.py tests/unit/openrouter_connector_tests/test_redaction.py tests/unit/openrouter_connector_tests/test_request_error.py tests/unit/openrouter_connector_tests/test_streaming_success.py tests/unit/proxy_logic_tests/test_parse_arguments.py tests/unit/proxy_logic_tests/test_process_commands_in_messages.py tests/unit/proxy_logic_tests/test_process_text_for_commands.py ')]'
2025-06-10 16:03:53,357 - src.command_parser - DEBUG - Finished processing messages. Final message count: 4. Commands processed overall: True
2025-06-10 16:03:53,357 - __main__ - DEBUG - Attempting backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1
2025-06-10 16:03:53,357 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-10 16:03:53,358 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-06-10 16:03:53,358 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-10 16:03:53,358 - httpcore.http11 - DEBUG - send_request_body.complete
2025-06-10 16:03:53,358 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-10 16:03:54,543 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=UTF-8'), (b'Vary', b'Origin'), (b'Vary', b'X-Origin'), (b'Vary', b'Referer'), (b'Content-Encoding', b'gzip'), (b'Date', b'Tue, 10 Jun 2025 14:03:54 GMT'), (b'Server', b'scaffolding on HTTPServer2'), (b'X-XSS-Protection', b'0'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'X-Content-Type-Options', b'nosniff'), (b'Server-Timing', b'gfet4t7; dur=1182'), (b'Alt-Svc', b'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'), (b'Transfer-Encoding', b'chunked')])
2025-06-10 16:03:54,543 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:streamGenerateContent "HTTP/1.1 200 OK"
2025-06-10 16:03:54,543 - __main__ - DEBUG - Result from Gemini backend chat_completions: <starlette.responses.StreamingResponse object at 0x0000022586C5D540>
2025-06-10 16:03:54,543 - __main__ - DEBUG - Attempt successful for backend: gemini, model: gemini:models/gemini-2.5-flash-preview-05-20, key_name: GEMINI_API_KEY_1
INFO:     127.0.0.1:16464 - "POST /v1/chat/completions HTTP/1.1" 200 OK
2025-06-10 16:03:54,544 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-10 16:03:54,658 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-06-10 16:03:54,658 - httpcore.http11 - DEBUG - response_closed.started
2025-06-10 16:03:54,658 - httpcore.http11 - DEBUG - response_closed.complete
